(function(o){typeof define=="function"&&define.amd?define(o):o()})(function(){"use strict";let o=$("canvas")[0],r=o.getContext("2d"),M=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0,0,0,0],[0,1,1,1,1,1,0],[0,0,0,1,0,0,0],[0,0,0,1,0,0,0],[1,1,1,1,1,1,1],[0,0,0,1,0,0,0],[0,0,1,0,1,0,0],[0,1,0,0,0,1,0],[1,0,0,0,0,0,1],[0,0,0,0,0,0,0]]],f=0,q=.3,D=["#3f4177","#3f4177","#ffb6f6","#3c97ff","#ff226c","#ff7a51","#3c97ff","#ff226c","7bff","#ff3ebf","ff4b"],I=0,p=0,l=[],m,P,s,_,v,x,h,c,u,w,n=[],T=!1,S=!1,B=!1,b={beginTime:"",normalColor:""},R=t=>{o.width=$(o).width(),o.height=$(o).height(),A()&&(o.width>=411?(S||(S=!0,b.beginTime=new Date(t.beginTime!==void 0?t.beginTime:"2018-06-05"),b.beginTime.setHours(0),b.beginTime=b.beginTime.getTime(),b.normalColor=t.normalColor!==void 0?t.normalColor:"#e4393c"),n=[],m=0,s=[-1,-1,-1,-1,-1],_=[-1,-1],v=[-1,-1],x=[-1,-1],T=!0,B=!1,F(),L()):(T=!1,alert("\u8BF7\u4F7F\u7528\u5C4F\u5E55\u5BBD\u5EA6411px\u53CA\u4EE5\u4E0A\u7684\u8BBE\u5907\u89C2\u770B\uFF01")))},A=()=>{if(window.orientation!==void 0){if(window.orientation===90)return!0;if(window.orientation===0)return alert("\u8BF7\u5C06\u624B\u673A\u6A2A\u5C4F\u518D\u89C2\u770B\uFF01"),T=!1,!1}else return!0},F=()=>{k();let t=h.length+1+c.length+1+u.length+1+w.length-l.length;o.width>=1647&&(f=7),o.width>=1441?f=6:o.width>=1235?f=5:o.width>=1029?f=4:o.width>=823?f=3:o.width>=617?f=2:f=1,I=(o.width-(205+206*f-t*16*(f+1)))/2,p=(o.height-(19+20*f))/2},L=()=>{T&&(r.clearRect(0,0,o.width,o.height),k(),H(),j(),E(),requestAnimationFrame(L))},k=()=>{let t=new Date().getTime(),e=Math.floor((t-b.beginTime)/1e3),i,a,y,C;l=[],h=[0,0,0,0,0],c=[0,0],u=[0,0],w=[0,0],i=Math.floor(e/(60*60*24)),h[4]=i%10,i=Math.floor(i/10),h[3]=i%10,i=Math.floor(i/10),h[2]=i%10,i=Math.floor(i/10),h[1]=i%10,i=Math.floor(i/10),h[0]=i%10,e%=60*60*24,l=[...h],l.push(11),a=Math.floor(e/(60*60)),c[1]=a%10,a=Math.floor(a/10),c[0]=a%10,e%=60*60,l=[...l,...c],l.push(10),y=Math.floor(e/60),u[1]=y%10,y=Math.floor(y/10),u[0]=y%10,e%=60,l=[...l,...u],l.push(10),C=e,w[1]=C%10,C=Math.floor(C/10),w[0]=C%10,l=[...l,...w];for(let z=0;z<5&&l[0]===0;z++)z===4&&l.shift(),l.shift()},H=()=>{for(let i=0;i<l.length;i++)N(g(i),l[i]);let t=h.length+1+c.length+1+u.length+1+w.length,e=m-t;m>=t&&l[e]!==s[0]&&(d(g(e),h[0]),s[0]=h[0]),e+=1,m>=t-1&&l[e]!==s[1]&&(d(g(e),h[1]),s[1]=h[1]),e+=1,m>=t-2&&l[e]!==s[2]&&(d(g(e),h[2]),s[2]=h[2]),e+=1,m>=t-3&&l[e]!==s[3]&&(d(g(e),h[3]),s[3]=h[3]),e+=1,m>=t-4&&l[e]!==s[4]&&(d(g(e),h[4]),s[4]=h[4]),e+=2,l[e]!==_[0]&&(d(g(e),c[0]),_[0]=c[0]),e+=1,l[e]!==_[1]&&(d(g(e),c[1]),_[1]=c[1]),e+=2,l[e]!==v[0]&&(d(g(e),u[0]),v[0]=u[0]),e+=1,l[e]!==v[1]&&(d(g(e),u[1]),v[1]=u[1]),e+=2,l[e]!==x[0]&&(d(g(e),w[0]),x[0]=w[0]),e+=1,l[e]!==x[1]&&(d(g(e),w[1]),x[1]=w[1])},g=t=>{if(l.length!==m){m=l.length,P=[];let e=I;for(let i=0;i<l.length;i++)i>0&&(l[i-1]!==10?e+=16*(f+1):e+=8*(f+1)),P.push(e)}return P[t]},N=(t,e)=>{for(let i=0;i<M[e].length;i++)for(let a=0;a<M[e][i].length;a++)M[e][i][a]===1&&(r.beginPath(),r.arc(t+a*2*(f+1)+(f+1),p+i*2*(f+1)+(f+1),f,0,2*Math.PI),r.closePath(),r.fillStyle=b.normalColor,r.fill())},d=(t,e)=>{for(let i=0;i<M[e].length;i++)for(let a=0;a<M[e][i].length;a++)if(M[e][i][a]===1){let y={x:t+a*2*(f+1)+(f+1),y:p+i*2*(f+1)+(f+1),activeColor:D[Math.floor(Math.random()*D.length)],g:1.5+Math.random(),vx:Math.pow(-1,Math.ceil(Math.random()*1e3))*4,vy:-1};n.push(y)}},j=()=>{for(let t=0;t<n.length;t++)r.beginPath(),r.arc(n[t].x,n[t].y,f,0,2*Math.PI),r.closePath(),r.fillStyle=n[t].activeColor,r.fill()},E=()=>{for(let t=0;t<n.length;t++)n[t].x+=n[t].vx,n[t].y+=n[t].vy,n[t].vy+=n[t].g,n[t].y>o.height-f&&(n[t].y=o.height-f,n[t].vy=-n[t].vy*q);for(let t=0;t<n.length;t++)(n[t].x<-(f*2)||n[t].x>o.width+f*2)&&(n.splice(t,1),t-=1)};window.weTimeInit=R,$(window).on("orientationchange",function(){r.clearRect(0,0,o.width,o.height),T=!1,setTimeout(function(){R(config)},100)}).on("resize",function(){B||(r.clearRect(0,0,o.width,o.height),B=!0,T=!1,setTimeout(function(){R(config)},200))})});